<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pylbo.automation.api &mdash; Pylbo stable documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="pylbo.automation.defaults" href="../defaults/index.html" />
    <link rel="prev" title="pylbo.automation" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Pylbo
          </a>
              <div class="version">
                2.0.0 - stable
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Package structure:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.automation</span></code></a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.automation.api</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../defaults/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.automation.defaults</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../generator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.automation.generator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../runner/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.automation.runner</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utilities/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.utilities</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../visualisation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.visualisation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_version/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo._version</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_containers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.data_containers</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../exceptions/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.exceptions</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../testing/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.testing</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Pylbo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo</span></code></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.automation</span></code></a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.automation.api</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/pylbo/automation/api/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pylbo.automation.api">
<span id="pylbo-automation-api"></span><h1><a class="reference internal" href="#module-pylbo.automation.api" title="pylbo.automation.api"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pylbo.automation.api</span></code></a><a class="headerlink" href="#module-pylbo.automation.api" title="Permalink to this heading"></a></h1>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this heading"></a></h2>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pylbo.automation.api.generate_parfiles" title="pylbo.automation.api.generate_parfiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_parfiles</span></code></a>(parfile_dict[, basename, ...])</p></td>
<td><p>Generates parfiles based on a given configuration dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pylbo.automation.api.run_legolas" title="pylbo.automation.api.run_legolas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_legolas</span></code></a>(parfiles[, remove_parfiles, nb_cpus, ...])</p></td>
<td><p>Runs the legolas executable for a given list of parfiles. If more than one parfile</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pylbo.automation.api.generate_parfiles">
<span class="sig-prename descclassname"><span class="pre">pylbo.automation.api.</span></span><span class="sig-name descname"><span class="pre">generate_parfiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parfile_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pylbo/automation/api.html#generate_parfiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylbo.automation.api.generate_parfiles" title="Permalink to this definition"></a></dt>
<dd><p>Generates parfiles based on a given configuration dictionary.
The separate namelists do not have to be taken into account, and a normal
dictionary should be supplied where the keys correspond to the namelist
items that are required. Typechecking is done automatically during parfile
generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parfile_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – Dictionary containing the keys to be placed in the parfile.</p></li>
<li><p><strong>basename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – The basename for the parfile, the <cite>.par</cite> suffix is added automatically and is
not needed. If multiple parfiles are generated, these
will be prepended by a 4-digit number (e.g. 0003myparfile.par).
If not provided, the basename will default to <cite>parfile</cite>.</p></li>
<li><p><strong>output_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.11)"><em>PathLike</em></a>) – Output directory where the parfiles are saved, defaults to the current
working directory if not specified. A subdirectory called <cite>parfiles</cite> will be
created in which the parfiles will be saved.</p></li>
<li><p><strong>subdir</strong> (<em>boolean</em>) – If <cite>.true.</cite> (default), creates a subdirectory <cite>parfiles</cite> in the output folder.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This routine is quite flexible and specifically designed for parametric studies.
You can specify both single values and list-like items as dictionary items.
This routine will automatically generate multiple parfiles if lists/numpy arrays
are present.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parfiles</strong> – A list with the paths to the parfiles that were generated. This list can be
passed immediately to <a class="reference internal" href="../../index.html#pylbo.run_legolas" title="pylbo.run_legolas"><code class="xref py py-func docutils literal notranslate"><span class="pre">pylbo.run_legolas()</span></code></a>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>This will generate a single parfile in a subdirectory <cite>parfile</cite> of the
current working directory.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pylbo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="s2">&quot;Cartesian&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;x_start&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;x_end&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;equilibrium_type&quot;</span><span class="p">:</span> <span class="s2">&quot;resistive_homo&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;gridpoints&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;write_eigenfunctions&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;basename_datfile&quot;</span><span class="p">:</span> <span class="s2">&quot;my_run&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;output_folder&quot;</span><span class="p">:</span> <span class="s2">&quot;output&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parfile</span> <span class="o">=</span> <span class="n">pylbo</span><span class="o">.</span><span class="n">generate_parfiles</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
<p>This will generate 10 parfiles in the directory <cite>my_parfiles</cite> relative to
the current working directory. The first parfile will have <cite>x_end = 1.0</cite> and 100
gridpoints, the second one will have <cite>x_end = 2.0</cite> and 150 gridpoints, etc.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pylbo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="s2">&quot;Cartesian&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;x_start&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;x_end&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;number_of_runs&quot;</span><span class="p">:</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;equilibrium_type&quot;</span><span class="p">:</span> <span class="s2">&quot;resistive_homo&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;gridpoints&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;write_eigenfunctions&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;basename_datfile&quot;</span><span class="p">:</span> <span class="s2">&quot;my_run&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;output_folder&quot;</span><span class="p">:</span> <span class="s2">&quot;output&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parfile_list</span> <span class="o">=</span> <span class="n">pylbo</span><span class="o">.</span><span class="n">generate_parfiles</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;my_parfiles&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylbo.automation.api.run_legolas">
<span class="sig-prename descclassname"><span class="pre">pylbo.automation.api.</span></span><span class="sig-name descname"><span class="pre">run_legolas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parfiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_parfiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/pylbo/automation/api.html#run_legolas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylbo.automation.api.run_legolas" title="Permalink to this definition"></a></dt>
<dd><p>Runs the legolas executable for a given list of parfiles. If more than one parfile
is passed, the runs can be performed in parallel using the multiprocessing module.
Parallelisation can be enabled by setting the <cite>nb_cpus</cite> kwarg to a number greater
than one, and is disabled by default.
Every CPU will have a single legolas executable subprocess associated
with it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parfiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – A string, list or array containing the paths to the parfile(s).
Accepts the output of <a class="reference internal" href="../../index.html#pylbo.generate_parfiles" title="pylbo.generate_parfiles"><code class="xref py py-func docutils literal notranslate"><span class="pre">pylbo.generate_parfiles()</span></code></a>.</p></li>
<li><p><strong>remove_parfiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If <cite>True</cite>, removes the parfiles after running Legolas. This will also remove
the containing folder if it turns out to be empty after the parfiles are
removed. If there are other files still in the folder it remains untouched.</p></li>
<li><p><strong>nb_cpus</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The number of CPUs to use when running Legolas. If equal to 1 then
parallelisation is disabled. Defaults to the maximum number of CPUs available
if a number larger than the available number is specified.</p></li>
<li><p><strong>executable</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.11)"><em>PathLike</em></a>) – The path to the legolas executable. If not specified, defaults to the
standard one in the legolas home directory.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If multiprocessing is enabled, it is usually a good idea to have the number
of runs requested divisible by the number of CPUs that are available. For example,
if 24 runs are requested it is good practice to use either 2, 4, 6 or 8 CPUs,
and avoid numbers like 3, 5 and 7.</p>
<p class="rubric">Examples</p>
<p>The example below will run a list of parfiles using using a local legolas
executable from the current directory, on 4 CPU’s.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pylbo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;parfiles&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.dat&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pylbo</span><span class="o">.</span><span class="n">run_legolas</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">nb_cpus</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">executable</span><span class="o">=</span><span class="s2">&quot;legolas&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="pylbo.automation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../defaults/index.html" class="btn btn-neutral float-right" title="pylbo.automation.defaults" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Niels Claes, Jordi De Jonghe and Rony Keppens (2020).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>