<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Legolas is a novel finite-element based code that allows for realistic MHD spectroscopy of one-dimensional plasmas.">
    
    <meta name="author" content="" >
    <link rel="icon" href="../favicon.png">

    <title>smod_derived_efs &ndash; Legolas v. 1.2.0 - stable</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Legolas v. 1.2.0 - stable </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/legolas.html">Program</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/legolas.html">Program</a></li>



          </ul>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>smod_derived_efs 
    <small>Submodule</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.2% of total for modules and submodules.">168 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/smod_derived_efs.f08"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/smod_derived_efs.f08.html'>smod_derived_efs.f08</a></li>
    
  
     <li class="active">smod_derived_efs</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-can_calculate_pp_quantities">can_calculate_pp_quantities</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-b02_on_ef_grid">B02_on_ef_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-b03_on_ef_grid">B03_on_ef_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-rho0_on_ef_grid">rho0_on_ef_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-t0_on_ef_grid">T0_on_ef_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-v1_ef">v1_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-v2_ef">v2_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-v3_ef">v3_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-a1_ef">a1_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-a2_ef">a2_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-a3_ef">a3_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-da2_ef">da2_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-da3_ef">da3_ef</a>
      
    </div>
  </div>
</div>









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#inters-0">Interfaces</a></h3></div>
  <div id="inters-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#interface-set_pp_quantities">set_pp_quantities</a>
      
    </div>
  </div>
</div>






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-check_if_pp_quantities_can_be_calculated">check_if_pp_quantities_can_be_calculated</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_equilibrium_on_eigenfunction_grid">set_equilibrium_on_eigenfunction_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_entropy">set_entropy</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_velocity_divergence">set_velocity_divergence</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_velocity_curl">set_velocity_curl</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_magnetic_field">set_magnetic_field</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_magnetic_field_divergence">set_magnetic_field_divergence</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_magnetic_field_curl">set_magnetic_field_curl</a>
      
    </div>
  </div>
</div>





<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#modprocs-0">Module Procedures</a></h3></div>
  <div id="modprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-initialise_derived_eigenfunctions">initialise_derived_eigenfunctions</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-calculate_derived_eigenfunctions">calculate_derived_eigenfunctions</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-clean_derived_eigenfunctions">clean_derived_eigenfunctions</a>
      
    </div>
  </div>
</div>







</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <p>This submodule calculates various quantities derived from the base eigenfunctions:
 - entropy S
 - <script type="math/tex">\nabla \cdot \mathbf{v}_1</script>
 - all 3 components of <script type="math/tex">\nabla \times \mathbf{v}_1</script>
 - <script type="math/tex">\nabla \cdot \mathbf{B}_1</script>
 - all 3 components of <script type="math/tex">\mathbf{B}_1</script>
 - all 3 components of <script type="math/tex">\nabla \times \mathbf{B}_1</script>
</p>
<p>It is assumed that B0 has no B01 component, such that the 1-direction is
already perpendicular to B0, and the parallel/perpendicular directions are
taken in the 23-plane. The right-handed triad is e1, B0/|B0|, (e1 x B0) / |B0|.</p>
      <br>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/mod_global_variables.html'>mod_global_variables</a></li>
    
    <li><a href='../module/mod_equilibrium_params.html'>mod_equilibrium_params</a></li>
    
  </ul>
      </li>
      
      
      <li class="list-group-item">
  <ul class="list-inline">
    <li><h5>Ancestors:</h5></li>
    
    <li><a href='../module/mod_eigenfunctions.html'>mod_eigenfunctions</a></li>
    
    
  </ul>
      </li>
      
      
      </ul>
    </div>
    

    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Used by</h3>
      </div>
      <ul class="list-group">
  
  <li class="list-group-item">  
    <ul class="list-inline">
      <li><h5>Descendants:</h5></li>
      
      <li><a href='../module/smod_derived_pp_efs.html'>smod_derived_pp_efs</a></li>
      
    </ul>
  </li>
  
  
      </ul>
    </div>
    

    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-can_calculate_pp_quantities">can_calculate_pp_quantities</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-b02_on_ef_grid">B02_on_ef_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-b03_on_ef_grid">B03_on_ef_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-rho0_on_ef_grid">rho0_on_ef_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-t0_on_ef_grid">T0_on_ef_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-v1_ef">v1_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-v2_ef">v2_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-v3_ef">v3_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-a1_ef">a1_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-a2_ef">a2_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-a3_ef">a3_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-da2_ef">da2_ef</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#variable-da3_ef">da3_ef</a>
      
    </div>
  </div>
</div>









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#inters-1">Interfaces</a></h3></div>
  <div id="inters-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#interface-set_pp_quantities">set_pp_quantities</a>
      
    </div>
  </div>
</div>






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-check_if_pp_quantities_can_be_calculated">check_if_pp_quantities_can_be_calculated</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_equilibrium_on_eigenfunction_grid">set_equilibrium_on_eigenfunction_grid</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_entropy">set_entropy</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_velocity_divergence">set_velocity_divergence</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_velocity_curl">set_velocity_curl</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_magnetic_field">set_magnetic_field</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_magnetic_field_divergence">set_magnetic_field_divergence</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-set_magnetic_field_curl">set_magnetic_field_curl</a>
      
    </div>
  </div>
</div>





<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#modprocs-1">Module Procedures</a></h3></div>
  <div id="modprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-initialise_derived_eigenfunctions">initialise_derived_eigenfunctions</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-calculate_derived_eigenfunctions">calculate_derived_eigenfunctions</a>
      
      <a class="list-group-item" href="../module/smod_derived_efs.html#proc-clean_derived_eigenfunctions">clean_derived_eigenfunctions</a>
      
    </div>
  </div>
</div>







    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-can_calculate_pp_quantities"></span>logical,</td>
  
  <td>private,</td>
  <td>save</td><td>::</td>
  <td><strong>can_calculate_pp_quantities</strong></td><td></td><td></td><td><p>Determines if parallel/perpendicular quantities can be computed</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b02_on_ef_grid"></span>real(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>B02_on_ef_grid</strong>(:)</td><td></td><td></td><td><p>array containing the interpolated B02</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b03_on_ef_grid"></span>real(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>B03_on_ef_grid</strong>(:)</td><td></td><td></td><td><p>array containing the interpolated B03</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rho0_on_ef_grid"></span>real(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>rho0_on_ef_grid</strong>(:)</td><td></td><td></td><td><p>array containing the interpolated rho0</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t0_on_ef_grid"></span>real(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>T0_on_ef_grid</strong>(:)</td><td></td><td></td><td><p>array containing the interpolated T0</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v1_ef"></span>complex(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>v1_ef</strong>(:)</td><td></td><td></td><td><p>v1 eigenfunction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v2_ef"></span>complex(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>v2_ef</strong>(:)</td><td></td><td></td><td><p>v2 eigenfunction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v3_ef"></span>complex(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>v3_ef</strong>(:)</td><td></td><td></td><td><p>v3 eigenfunction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a1_ef"></span>complex(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>a1_ef</strong>(:)</td><td></td><td></td><td><p>a1 eigenfunction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a2_ef"></span>complex(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>a2_ef</strong>(:)</td><td></td><td></td><td><p>a2 eigenfunction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a3_ef"></span>complex(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>a3_ef</strong>(:)</td><td></td><td></td><td><p>a3 eigenfunction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-da2_ef"></span>complex(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>da2_ef</strong>(:)</td><td></td><td></td><td><p>derivative of a2 eigenfunction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-da3_ef"></span>complex(kind=dp),</td>
  
  <td>private,</td>
  <td>allocatable</td><td>::</td>
  <td><strong>da3_ef</strong>(:)</td><td></td><td></td><td><p>derivative of a3 eigenfunction</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    <section>
   <h2>Interfaces</h2>
   
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-set_pp_quantities"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
module module subroutine set_pp_quantities(locB, locCurlB, locV, locCurlV, ef_index)
    
    
   
   <a href='../proc/set_pp_quantities.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>locB</strong>(2)</td><td><p>position indices for parallel/perpendicular B components</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>locCurlB</strong>(2)</td><td><p>position indices for parallel/perpendicular curl(B) components</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>locV</strong>(2)</td><td><p>position indices for parallel/perpendicular v components</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>locCurlV</strong>(2)</td><td><p>position indices for parallel/perpendicular curl(v) components</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_index</strong></td><td><p>index of the eigenfunction in the "quantities" array attribute</p></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  
  </ul>
</div>

    
    </section>
  <br>
    

    
    
    
    
    

    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-check_if_pp_quantities_can_be_calculated"></span><h3>
subroutine <a href='../proc/check_if_pp_quantities_can_be_calculated.html'>check_if_pp_quantities_can_be_calculated</a>()
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Determines if parallel/perpendicular quantities can be calculated and
sets the corresponding module flag. This flag will be false if there is a
non-zero B01 component present, or no magnetic field.</p>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-set_equilibrium_on_eigenfunction_grid"></span><h3>
subroutine <a href='../proc/set_equilibrium_on_eigenfunction_grid.html'>set_equilibrium_on_eigenfunction_grid</a>()
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Sets the B02, B03, rho0 and T0 equilibrium components on the eigenfunction grid
instead of on the Gaussian grid, these are used for calculating the derived
eigenfunction quantities. No interpolation needed since the Gaussian grid is
always finer than the eigenfunction grid, so we can get away by simply
looking up the nearest values for every point in the eigenfunction grid.</p>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-set_entropy"></span><h3>
subroutine <a href='../proc/set_entropy.html'>set_entropy</a>(loc, ef_index)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Calculates the entropy S1 and places it at location "loc" in the main array.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>loc</strong></td><td><p>position index in the main array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_index</strong></td><td><p>index of the eigenfunction in the "quantities" array attribute</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-set_velocity_divergence"></span><h3>
subroutine <a href='../proc/set_velocity_divergence.html'>set_velocity_divergence</a>(loc, ef_index, rvec)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Calculates the divergence of the perturbed velocity v1</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>loc</strong></td><td><p>position index in the main array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_index</strong></td><td><p>index of the eigenfunction in the "quantities" array attribute</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>complex(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rvec</strong>(:)</td><td><p>right eigenvector</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-set_velocity_curl"></span><h3>
subroutine <a href='../proc/set_velocity_curl.html'>set_velocity_curl</a>(loc, ef_index, rvec)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Sets the three components of velocity curl.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>loc</strong>(3)</td><td><p>position indices in the main array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_index</strong></td><td><p>index of the eigenfunction in the "quantities" array attribute</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>complex(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rvec</strong>(:)</td><td><p>right eigenvector</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-set_magnetic_field"></span><h3>
subroutine <a href='../proc/set_magnetic_field.html'>set_magnetic_field</a>(loc, ef_index)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Calculates the perturbed magnetic field.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>loc</strong>(:)</td><td><p>position indices in the main array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_index</strong></td><td><p>index of the eigenfunction in the "quantities" array attribute</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-set_magnetic_field_divergence"></span><h3>
subroutine <a href='../proc/set_magnetic_field_divergence.html'>set_magnetic_field_divergence</a>(loc, ef_index)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Calculates the divergence of the perturbed magnetic field</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>loc</strong></td><td><p>position index in the main array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_index</strong></td><td><p>index of the eigenfunction in the "quantities" array attribute</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-set_magnetic_field_curl"></span><h3>
subroutine <a href='../proc/set_magnetic_field_curl.html'>set_magnetic_field_curl</a>(loc, ef_index, rvec)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Calculates the curl of the perturbed magnetic field.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>loc</strong>(3)</td><td><p>position indices in the main array</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ef_index</strong></td><td><p>index of the eigenfunction in the "quantities" array attribute</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>complex(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rvec</strong>(:)</td><td><p>right eigenvector</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    </section>    
    <br>
    
    
    
    
        

        

        
        <section>
        <h2>Module Procedures</h2>
        
        
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-initialise_derived_eigenfunctions"></span><h3>
module procedure <a href='../proc/initialise_derived_eigenfunctions.html'>initialise_derived_eigenfunctions</a> <small>module module subroutine initialise_derived_eigenfunctions(nb_eigenfuncs)</small>
    
    
   <a href='../interface/initialise_derived_eigenfunctions.html'><button type="button" class="btn btn-info depwarn">Interface &rarr;</button></a>
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Initialised the derived eigenfunction array, sets the corresponding names and
vector indices, allocates the (subset of) derived eigenfunctions</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nb_eigenfuncs</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

        
        
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-calculate_derived_eigenfunctions"></span><h3>
module procedure <a href='../proc/calculate_derived_eigenfunctions.html'>calculate_derived_eigenfunctions</a> <small>module module subroutine calculate_derived_eigenfunctions(right_eigenvectors)</small>
    
    
   <a href='../interface/calculate_derived_eigenfunctions.html'><button type="button" class="btn btn-info depwarn">Interface &rarr;</button></a>
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Calculates the derived eigenfunction quantities corresponding to the requested
eigenvalues and sets them as attributes for the corresponding types.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>complex(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>right_eigenvectors</strong>(:,:)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

        
        
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-clean_derived_eigenfunctions"></span><h3>
module procedure <a href='../proc/clean_derived_eigenfunctions.html'>clean_derived_eigenfunctions</a> <small>module module subroutine clean_derived_eigenfunctions()</small>
    
    
   <a href='../interface/clean_derived_eigenfunctions.html'><button type="button" class="btn btn-info depwarn">Interface &rarr;</button></a>
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Cleaning routine.</p>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  </div>
  </div>

        
        </section>    
        
    
    
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Legolas v. 1.2.0 - stable was developed by <br>&copy; 2021 
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    
  </body>
</html>